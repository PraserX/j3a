<!DOCTYPE html>
<html lang="en-us">

	<head>
		<meta charset="utf-8">
		<meta name="generator" content="Hugo 0.20.2" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="./css/materialize.min.css">
		<link rel="stylesheet" href="./css/custom.css">
		
		<title>About - J3A</title>
	</head>

	<body>
		<script type="text/javascript" src="./js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="./js/materialize.min.js"></script>
		<script type="text/javascript" src="./js/j3a.min.js"></script>
		
		<header class="free">
		</header>
		
		<main>
			<div class="container">
				<div class="row row-no-margin-padding">
					<div class="col s12 xl10 offset-xl1">
						<div class="menu hide-on-small-only">
							<ul class="links left">
								<li><a href="./index.html">Main</a></li>
								<li><a class="active" href="./about.html">About</a></li>
								<li><a id="link-login" href="./login.html">Login</a></li>
								<li><a id="link-logout" style="display: none" href="#">Logout</a></li>
							</ul>
							<ul class="brands right">
								<li class="user"><p id="showname"></p></li>
								<li><a href="https://github.com/PraserX/j3a" target="_blank"><i class="fa fa-github"></i></a></li>
							</ul>
							<div style="clear: both;"></div>
						</div>
						<div class="menu hide-on-med-and-up">
							<div class="small">
								<ul class="links">
									<li><a href="./index.html">Main</a></li>
									<li><a class="active" href="./about.html">About</a></li>
									<li><a id="link-login-sm" href="./login.html">Login</a></li>
									<li><a id="link-logout-sm" style="display: none" href="#">Logout</a></li>
								</ul>
								<ul class="brands">
									<li class="user"><p id="showname-sm"></p></li>
									<li><a href="https://github.com/PraserX/j3a" target="_blank"><i class="fa fa-github"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col s12 xl10 offset-xl1">
						<div class="content">
							<h2>About</h2>
							<p>This page is all about demo. You can try this features here. Below you have users with passwords.</p>
							
							<a href="./page/registered.html">Page only for users with role Registered</a><br>
							<a href="./page/author.html">Page only for users with role Author</a>
							
							<h3>Accounts</h3>
							<table class="striped">
								<thead>
									<tr>
										<th>Username</th>
										<th>Password/Certificate</th>
										<th>Role</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>bob</td>
										<td>bob</td>
										<td>Registered</td>
							 		</tr>
									<tr>
										<td>jimbo</td>
										<td>jimbo</td>
										<td>Author</td>
							 		</tr>
									<tr>
										<td>admin</td>
										<td>admin</td>
										<td>Administrator</td>
							 		</tr>
									<tr>
										<td>mike</td>
										<td>security/users/publickeys/mike_private.pem</td>
										<td>Registered</td>
							 		</tr>
								</tbody>
							</table>
							
							<p><i>-- Administrator inherits access rights from Registered and Author.</i></p>
							
							<h3>Author</h3>
							<div class="row">
								<div class="col s12 m10 l8">
									<div class="row valign-wrapper">
										<div class="col s2">
											<img src="./img/photo.png" alt="" class="circle responsive-img">
										</div>
										<div class="col s10">
											<span class="black-text">Praser</span><br/>
											<span><a href="https://github.com/PraserX">https://github.com/PraserX</a></span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
		
		<footer>
			<div class="container">
				<div class="row">
					<div class="col s12 xl10 offset-xl1">
						<div class="content">
							&copy; 2017 <a href="https://github.com/PraserX/" target="_blank">Praser</a>
						</div>
					</div>
				</div>
			</div>
		</footer>
		<!--
    <script src="http://localhost/nixs/js/j3a.js"></script>
    -->
    <!--
    <script src="https://praserx.github.io/j3a/demo/js/j3a.js"></script>
    -->
    <script type="text/javascript">
		//////////////////////////////////////////////////////////////////////////////////
        // J3A config, init and post processing
        //////////////////////////////////////////////////////////////////////////////////
		
		// locahost
        //var configUrl = "http://localhost/nixs/config.json";
		// production server
        var configUrl = "https://praserx.github.io/j3a/demo/config.json";
        
		// page prefix
        var prefix = "jtasite";
		
        j3a = new J3A();
        j3a.EnableDevMode();

        // Run initialization
        j3a.Init(configUrl, false, prefix).then(function () {
            $(document).ready(function () {
                // Run J3A page postprocessing
                j3a.RunPostProcessing().then(function (result) {  });
            });
        }).catch(function (error) {
            console.log(error);
        });
		
		
		//////////////////////////////////////////////////////////////////////////////////
        // Handle page dynamic changes (quick action!)
        //////////////////////////////////////////////////////////////////////////////////

        $(document).ready(function () {
            if (J3A.Logged(prefix) == true) {
                $("#link-login").hide();
                $("#link-logout").show();
				
				$("#link-login-sm").hide();
                $("#link-logout-sm").show();
            }
        });
		
		$(document).ready(function () {
            if (J3A.Logged(prefix) == true) {
				$("#showname").text(j3a.GetUser().username);
				$("#showname-sm").text(j3a.GetUser().username);
				$(".user").each(function( i ) {
					this.style.display = "inline-block";
				});
            }
        });
        
        //////////////////////////////////////////////////////////////////////////////////
        // Certificate input loading --> Via new FileReader API (still under development)
        //////////////////////////////////////////////////////////////////////////////////
        var certificate = null;

        $(document).ready(function () {
            $('#certificate').on('change', function (e) {
                var file = e.target.files[0];
                if (!file) { return; }

                // New file reader instance
                var reader = new FileReader();

                // What to do if file is loaded
                reader.onload = function (e) {
                    var contents = e.target.result;
                    certificate = contents;
                };

                // Now read file
                reader.readAsText(file);
            });
        });

        //////////////////////////////////////////////////////////////////////////////////
        // Click events
        //////////////////////////////////////////////////////////////////////////////////

        // Login button
        $("#login-form").on("submit", function (e) {
            e.preventDefault();
            j3a.Login($("#username").val(), $("#password").val()).then(function (result) {
                window.location.href = j3a.GetBaseUrl(); // Now redirect to main page!
            }, function (err) {
                console.log(err);
                $("#login-failed").show();
            });
        });

        // Login Certificate button
        $("#login-cert-form").on("submit", function (e) {
            e.preventDefault();
            j3a.LoginByPrivateKey($("#username").val(), certificate).then(function (result) {
                window.location.href = j3a.GetBaseUrl(); // Now redirect to main page!
            }, function (err) {
                console.log(err);
                $("#login-failed").show();
            });
        });

        // Logout button
        $("#link-logout").click(function () {
            j3a.PartialLogout();
            window.location.href = j3a.GetBaseUrl();
        });
		
		// Logout-sm button
        $("#link-logout-sm").click(function () {
            j3a.PartialLogout();
            window.location.href = j3a.GetBaseUrl();
        });
    </script>
</body>
</html>
